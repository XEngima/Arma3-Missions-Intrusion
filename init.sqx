using Intrusion.Server;
using Intrusion.Ai;

enableSaving [false, false];

// First common
call compile preprocessFileLineNumbers "Sqx\Collections\ArrayHandler.sqx";
call compile preprocessFileLineNumbers "Common\InitCommon.sqx";

// Then server
if (isServer) then {
	call compile preprocessFileLineNumbers "Server\InitServer.sqx";
};

// Then clients
if (!isDedicated) then {
	call compile preprocessFileLineNumbers "Client\InitClient.sqx";
};

// And finally Remote
call compile preprocessFileLineNumbers "Communication\InitCommunication.sqx";

// And then start the mission
if (isServer) then {
	[gServer, gServerConfig, gCommonConfig] call MissionEngine.RunAsync;
	call AiService.StartAsync;
	//call Sqx.UnitTest.TestEngine.RunDelayedAsync;
};
