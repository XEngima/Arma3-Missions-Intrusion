/*
 * Name:	IUnitCounter
 * Date:	2019-03-02
 * Version: 1.0
 * Author:  Engima
 *
 * Description:
 * A class that counts units (players and AI bots) in play.
 */

using Intrusion.Ai;

namespace Intrusion.Server
{
	public class UnitCounter : IUnitCounter
	{
		private fields ["_mAiUnitCounter" as IAiUnitCounter];
		
		public constructor("_gameplayConfig" as IGameplayConfig, "_aiUnitCounter" as IAiUnitCounter)
		{
			private ["_lobbySlotsCount" as Scalar];
			
			_mAiUnitCounter = _aiUnitCounter;
		
			_lobbySlotsCount = 0;
			
			{
				_lobbySlotsCount = _lobbySlotsCount + playableSlotsNumber _x;
			} foreach _gameplayConfig.CompetingSides as Side;
			
			_self.LobbySlotsCount = _lobbySlotsCount;
		};
	
		public method Scalar CountUnitsInPlay()
		{
			private _no = (count call BIS_fnc_listPlayers) + (call _mAiUnitCounter.CountUnits);
			_no
		};
		
		public property Scalar LobbySlotsCount { get; private set; };
	};
};
