call compile preprocessFileLineNumbers "Ai\Classes\Configs\AiUnitsConfig.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Configs\AiWeaponsConfig.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Handlers\AiSquadHandler.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\AiSquad.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\AiUnitInfo.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\AiUnitBalancer.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\AiWeaponInfo.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\World.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\AiSquadBrain.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\Knowledge.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\ActionPerformer.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Objects\Actions\MoveAction.sqx";
call compile preprocessFileLineNumbers "Ai\Classes\Services\AiService.sqx";

using Intrusion.Common;
using Intrusion.Ai;

[] spawn {
	private ["_aiService" as IService, "_aiUnitBalancer" as IAiUnitBalancer];
	
	sleep 5;

	_aiUnitBalancer = [gServer.UnitCounter, gCommon.MissionParametersHandler.AiWestFrequency, gCommon.MissionParametersHandler.AiEastFrequency] new AiUnitBalancer;
	_aiService = [
		gServer.AiSquadHandler,
		_aiUnitBalancer, 
		gServerConfig.Gameplay, 
		new AiUnitsConfig, 
		gCommonConfig.MapMarkers,
		gServer.VehicleSpawner, 
		gCommonConfig.Professions,
		gServer.SquadHandler, 
		gCommon.MissionParametersHandler.AiSkillLevel, 
		gServer.ResourceLocationHandler,
		gServer.InventedTechnologiesCollection,
		gServer.UnitSpawner,
		gCommonConfig.Professions,
		new AiWeaponsConfig] new AiService;
	
	call _aiService.RunAsync;
};
